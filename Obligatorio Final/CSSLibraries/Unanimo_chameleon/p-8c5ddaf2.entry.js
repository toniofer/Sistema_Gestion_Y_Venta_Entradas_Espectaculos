import{r as t,c as i,h as e,H as n,g as s}from"./p-23c5f09f.js";class r extends HTMLElement{constructor(){super()}get grid(){var t;return null!==(t=this.parentGrid)&&void 0!==t?t:this.loadParentGrid()}get rowId(){return this.getAttribute("rowid")}set highlighted(t){!0===t?(this.setAttribute("highlighted",""),this.grid.onRowHighlightedClass&&this.classList.add(this.grid.onRowHighlightedClass)):(this.removeAttribute("highlighted"),this.grid.onRowHighlightedClass&&this.classList.remove(this.grid.onRowHighlightedClass))}get highlighted(){return this.hasAttribute("highlighted")}set selected(t){!0===t?(this.setAttribute("selected",""),this.grid.onRowSelectedClass&&this.classList.add(this.grid.onRowSelectedClass)):(this.removeAttribute("selected"),this.grid.onRowSelectedClass&&this.classList.remove(this.grid.onRowSelectedClass))}get selected(){return this.hasAttribute("selected")}loadParentGrid(){return this.parentGrid=this.closest("ch-grid"),this.parentGrid}}customElements.define("ch-grid-row",r);class o extends HTMLElement{constructor(){super()}get rowId(){return this.parentElement.rowId}get cellId(){return this.getAttribute("cellid")}set selected(t){!0===t?this.setAttribute("selected",""):this.removeAttribute("selected")}get selected(){return this.hasAttribute("selected")}}function a(t){return t.composedPath().find(t=>"CH-GRID-ROW"===t.tagName)}customElements.define("ch-grid-cell",o);class l{constructor(t,i){this.lastTargetOrder=0,this.columns=i.map(t=>({column:t,rect:t.getBoundingClientRect(),translateX:0,order:t.order})),this.column=this.columns.find(i=>i.column.columnId==t),this.columns.forEach(this.setColumnHiddenRect.bind(this))}dragging(t){const i=this.column.column.order;let e=0,n=!1;return this.column.translateX=0,this.columns.forEach(n=>{const s=n.column.order,r=i>s?-1:1,o=i>s?1:-1;n.rect.left<t&&t<n.rect.right&&s!=i?(n.translateX=this.column.rect.width*o,n.order=n.column.order+o,this.column.translateX+=n.rect.width*r,e=s):t<n.rect.left&&s<i||t>n.rect.right&&s>i?(n.translateX=this.column.rect.width*o,n.order=n.column.order+o,this.column.translateX+=n.rect.width*r):s!=i&&(n.translateX=0,n.order=n.column.order)}),this.column.order=e||this.column.column.order,n=e!=this.lastTargetOrder,this.lastTargetOrder=e,n}dragEnd(){this.columns.forEach(t=>{t.column.order=t.order,t.translateX=0})}getColumnStyle(t){return{[`--ch-grid-column-${t.physicalOrder}-transform`]:`translateX(${this.columns[t.physicalOrder-1].translateX}px)`}}getColumnsFirstLast(){let t,i;return this.columns.forEach(e=>{e.column.hidden||t&&!(e.order<t.order)||(t=e),e.column.hidden||i&&!(e.order>i.order)||(i=e)}),{columnFirst:t.column,columnLast:i.column}}setColumnHiddenRect(t){if(t.column.hidden){const i=this.getPreviousSiblingVisible(t)||this.getNextSiblingVisible(t);t.rect=new DOMRect(t.column.order<i.column.order?i.rect.left:i.rect.right,i.rect.y,0,i.rect.height)}}getPreviousSiblingVisible(t){let i;return this.columns.forEach(e=>{!e.column.hidden&&e.column.order<t.column.order&&(!i||e.column.order>i.column.order)&&(i=e)}),i}getNextSiblingVisible(t){let i;return this.columns.forEach(e=>{!e.column.hidden&&e.column.order>t.column.order&&(!i||e.column.order<i.column.order)&&(i=e)}),i}}class h{constructor(t){this.grid=t,this.defineColumns(),this.defineColumnsVariables()}defineColumns(){this.columns=Array.from(this.grid.el.querySelectorAll("ch-grid-column")),this.columns.forEach(t=>{this.defineColumnId(t),this.defineColumnIndex(t),this.defineColumnOrder(t),this.defineColumnSize(t),this.defineColumnDisplayObserver(t)})}defineColumnId(t){t.columnId||(t.columnId="grid-column-"+(this.columns.indexOf(t)+1))}defineColumnIndex(t){t.physicalOrder=this.columns.indexOf(t)+1}defineColumnOrder(t){t.order||(t.order=t.physicalOrder)}defineColumnSize(t){t.size||(t.size="auto")}defineColumnDisplayObserver(t){if(t.displayObserverClass&&!t.hidden){let i=document.createElement("ch-grid-column-display");i.setAttribute("slot","column-display"),i.setAttribute("class",t.displayObserverClass),i.column=t,this.grid.el.appendChild(i)}}defineColumnsVariables(){const t=document.head.querySelector("#ChGrid.ColumnsVariables");if(!t||parseInt(t.getAttribute("data-columns"))<this.columns.length){let i="";for(let t=1;t<=this.columns.length;t++)i+=`ch-grid-column:nth-child(${t}), ch-grid-cell:nth-child(${t}) {\n                    display: var(--ch-grid-column-${t}-display);\n                    grid-column: var(--ch-grid-column-${t}-position, ${t});\n                    margin-inline-start: var(--ch-grid-column-${t}-margin-start);\n                    border-inline-start: var(--ch-grid-column-${t}-border-start);\n                    padding-inline-start: var(--ch-grid-column-${t}-padding-start);\n                    margin-inline-end: var(--ch-grid-column-${t}-margin-end);\n                    border-inline-end: var(--ch-grid-column-${t}-border-end);\n                    padding-inline-end: var(--ch-grid-column-${t}-padding-end);\n                    transform: var(--ch-grid-column-${t}-transform);\n                }`;t?(t.setAttribute("data-columns",this.columns.length.toString()),t.innerHTML=i):document.head.insertAdjacentHTML("beforeend",`<style id="ChGrid.ColumnsVariables" data-columns="${this.columns.length}">@layer ch-grid {${i}}</style>`)}}columnDragStart(t){this.columnDragManager=new l(t,this.columns)}columnDragging(t){return this.columnDragManager.dragging(t)}columnDragEnd(){this.columnDragManager.dragEnd(),this.columnDragManager=null}getGridStyle(){return Object.assign(Object.assign(Object.assign(Object.assign({display:"grid"},this.getGridTemplateColumns()),this.getRowBoxSimulationStyle()),this.getDragTransitionStyle()),this.getColumnsStyle())}getGridTemplateColumns(){return{"grid-template-columns":this.columns.map(t=>`var(--ch-grid-column-${t.physicalOrder}-size)`).join(" ")}}getRowBoxSimulationStyle(){const{columnFirst:t,columnLast:i}=this.columnDragManager?this.columnDragManager.getColumnsFirstLast():this.getColumnsFirstLast();return{[`--ch-grid-column-${t.physicalOrder}-margin-start`]:"var(--ch-grid-fallback, inherit)",[`--ch-grid-column-${t.physicalOrder}-border-start`]:"var(--ch-grid-fallback, inherit)",[`--ch-grid-column-${t.physicalOrder}-padding-start`]:"var(--ch-grid-fallback, inherit)",[`--ch-grid-column-${i.physicalOrder}-margin-end`]:"var(--ch-grid-fallback, inherit)",[`--ch-grid-column-${i.physicalOrder}-border-end`]:"var(--ch-grid-fallback, inherit)",[`--ch-grid-column-${i.physicalOrder}-padding-end`]:"var(--ch-grid-fallback, inherit)"}}getColumnsFirstLast(){let t,i;return this.columns.forEach(e=>{e.hidden||t&&!(e.order<t.order)||(t=e),e.hidden||i&&!(e.order>i.order)||(i=e)}),{columnFirst:t,columnLast:i}}getDragTransitionStyle(){return{"--column-drag-transition-duration":this.columnDragManager?".2s":"0s"}}getColumnsStyle(){return this.columns.reduce((t,i)=>Object.assign(Object.assign({},t),this.getColumnStyle(i)),{})}getColumnStyle(t){return Object.assign(Object.assign(Object.assign(Object.assign({},this.getColumnSizeStyle(t)),this.getColumnOrderStyle(t)),this.getColumnDisplayStyle(t)),this.getColumnDraggingStyle(t))}getColumnSizeStyle(t){return{[`--ch-grid-column-${t.order}-size`]:t.hidden?"0px":t.size}}getColumnOrderStyle(t){return{[`--ch-grid-column-${t.physicalOrder}-position`]:t.order.toString()}}getColumnDisplayStyle(t){return t.hidden?{[`--ch-grid-column-${t.physicalOrder}-display`]:"none"}:null}getColumnDraggingStyle(t){return this.columnDragManager?this.columnDragManager.getColumnStyle(t):null}}const d=class{constructor(e){t(this,e),this.selectionChanged=i(this,"selectionChanged",7),this.cellClicked=i(this,"cellClicked",7),this.rowsSelected=[],this.rowSelectionMode="single"}componentWillLoad(){this.gridManager=new h(this),this.gridStyle=this.gridManager.getGridStyle()}componentShouldUpdate(t,i,e){if("rowSelected"===e)return!1}rowSelectedHandler(t){this.selectionChanged.emit({rowsId:t.map(t=>t.rowId)})}cellSelectedHandler(t){this.cellClicked.emit({rowId:t.rowId,cellId:t.cellId})}mouseMoveHandler(t){"none"!=this.rowSelectionMode&&(this.rowHighlighted=function(t,i){const e=a(t);return e?e.highlighted||(i&&(i.highlighted=!1),e.highlighted=!0):i&&(i.highlighted=!1),e}(t,this.rowHighlighted))}clickHandler(t){"none"!=this.rowSelectionMode&&(this.cellSelected=function(t,i){const e=function(t){return t.composedPath().find(t=>"CH-GRID-CELL"===t.tagName)}(t);return e&&!e.selected&&(i&&(i.selected=!1),e.selected=!0),e||i}(t,this.cellSelected),this.rowsSelected=function(t,i,e){const n=a(t);if(n){if(!n.selected)return e&&(0==i.length||t.ctrlKey)?(n.selected=!0,i.concat([n])):(i.forEach(t=>t.selected=!1),n.selected=!0,[n]);if(t.ctrlKey)return n.selected=!1,i.filter(t=>t!==n)}return i}(t,this.rowsSelected,"multiple"===this.rowSelectionMode))}columnStyleChangedHandler(){this.gridManager&&(this.gridStyle=this.gridManager.getGridStyle())}columnDragStartHandler(t){this.gridManager.columnDragStart(t.detail.columnId)}columnDraggingHandler(t){this.gridManager.columnDragging(t.detail.positionX)&&(this.gridStyle=this.gridManager.getGridStyle())}columnDragEndHandler(){this.gridManager.columnDragEnd(),this.gridStyle=this.gridManager.getGridStyle()}settingsShowClickedHandler(){this.settingsUI.show=!0}settingsCloseClickedHandler(){this.settingsUI.show=!1}render(){return e(n,null,e("header",{part:"header"},e("slot",{name:"header"})),e("section",{class:"main",style:this.gridStyle,part:"main"},e("slot",null)),e("aside",null,this.renderSettings(),e("slot",{name:"column-display"}),e("slot",{name:"row-actions"})),e("footer",{part:"footer"},e("slot",{name:"footer"})))}renderSettings(){return e("ch-grid-settings",{ref:t=>this.settingsUI=t,exportparts:"\n          mask:settings-mask,\n          window:settings-window,\n          header:settings-header,\n          caption:settings-caption,\n          close:settings-close,\n          main:settings-main,\n          footer:settings-footer\n        "},e("slot",{name:"settings"},e("ch-grid-settings-columns",{part:"settings-columns",columns:[...this.gridManager.columns],exportparts:"\n              column:settings-columns-item,\n              column-label:settings-columns-label,\n              column-visible:settings-columns-visible\n            "})))}get el(){return s(this)}static get watchers(){return{rowsSelected:["rowSelectedHandler"],cellSelected:["cellSelectedHandler"]}}};d.style=":host{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column}.main{display:none;grid-auto-flow:dense;overflow-x:auto}";const c=class{constructor(e){t(this,e),this.refreshClicked=i(this,"refreshClicked",7),this.handleClick=t=>{t.stopPropagation(),this.refreshClicked.emit()}}render(){return e(n,{role:"button",tabindex:"0",disabled:this.disabled,onClick:this.handleClick})}};c.style="@layer ch-grid {\n  ch-grid-action-refresh[disabled] {\n    pointer-events: none;\n  }\n}";const u=class{constructor(e){t(this,e),this.settingsShowClicked=i(this,"settingsShowClicked",7),this.handleClick=t=>{t.stopPropagation(),this.settingsShowClicked.emit()}}render(){return e(n,{role:"button",tabindex:"0",disabled:this.disabled,onClick:this.handleClick})}};u.style="@layer ch-grid {\n  ch-grid-action-settings[disabled] {\n    pointer-events: none;\n  }\n}";const g=class{constructor(i){t(this,i)}get el(){return s(this)}};g.style="";const m=class{constructor(e){t(this,e),this.columnHiddenChanged=i(this,"columnHiddenChanged",7),this.columnSizeChanging=i(this,"columnSizeChanging",7),this.columnSizeChanged=i(this,"columnSizeChanged",7),this.columnOrderChanged=i(this,"columnOrderChanged",7),this.columnSortChanged=i(this,"columnSortChanged",7),this.columnDragStarted=i(this,"columnDragStarted",7),this.columnDragging=i(this,"columnDragging",7),this.columnDragEnded=i(this,"columnDragEnded",7),this.columnNamePosition="text",this.hidden=!1,this.hideable=!0,this.resizeable=!0,this.sortable=!0,this.settingable=!0,this.showSettings=!1,this.dragging=!1,this.dragMouseMoveFn=this.dragMouseMoveHandler.bind(this)}componentDidLoad(){this.el.addEventListener("mousedown",this.mousedownHandler.bind(this))}sizeHandler(){this.columnSizeChanging.emit({columnId:this.columnId,size:this.size})}hiddenHandler(){this.columnHiddenChanged.emit({columnId:this.columnId,hidden:this.hidden})}orderHandler(){this.columnOrderChanged.emit({columnId:this.columnId,order:this.order})}sortDirectionHandler(){this.sortDirection&&this.columnSortChanged.emit({columnId:this.columnId,sortDirection:this.sortDirection})}clickHandler(){this.dragging?this.dragging=!1:this.sortable&&(this.sortDirection="asc"==this.sortDirection?"desc":"asc")}settingsCloseClickedHandler(){this.showSettings=!1}columnResizeFinishedHandler(){this.columnSizeChanged.emit({columnId:this.columnId,size:this.size})}mousedownHandler(t){t.preventDefault(),t.stopPropagation(),this.dragMouseDownHandler(t),document.addEventListener("mousemove",this.dragMouseMoveFn,{passive:!0}),document.addEventListener("mouseup",this.dragMouseUpHandler.bind(this),{once:!0})}dragMouseDownHandler(t){this.dragMouseMoveStartPositionX=t.pageX,this.columnDragStarted.emit({columnId:this.columnId})}dragMouseMoveHandler(t){(this.dragging||Math.abs(this.dragMouseMoveStartPositionX-t.pageX)>5)&&(this.dragging=!0,this.columnDragging.emit({columnId:this.columnId,positionX:t.pageX,direction:t.movementX>0?"right":"left"}))}dragMouseUpHandler(){document.removeEventListener("mousemove",this.dragMouseMoveFn),this.columnDragEnded.emit({columnId:this.columnId})}settingsMouseDownHandler(t){t.stopPropagation()}settingsClickHandler(t){t.stopPropagation(),this.showSettings=!0}render(){return e(n,null,e("ul",{class:"bar",part:"bar"},this.renderName(),this.renderSort(),this.renderSettings(),this.renderResize()),e("ch-grid-column-settings",{column:this,onMouseDown:this.settingsMouseDownHandler,show:this.showSettings,exportparts:"\n            mask:settings-mask,\n            window:settings-window,\n            header:settings-header,\n            caption:settings-caption,\n            close:settings-close,\n            main:settings-main,\n            footer:settings-footer\n          "},e("slot",{name:"settings"})))}renderName(){return e("li",{class:"name",part:"bar-name",title:"title"==this.columnNamePosition?this.columnName:null},this.columnIconUrl?e("img",{class:"name-icon",part:"bar-name-icon",src:this.columnIconUrl}):e("div",{class:"name-icon",part:"bar-name-icon"}),e("span",{class:"name-text",part:"bar-name-text",hidden:"text"!=this.columnNamePosition},this.columnName))}renderSort(){return e("li",{class:"sort",part:"bar-sort",hidden:!this.sortable},e("div",{class:"sort-asc",part:"bar-sort-ascending"}),e("div",{class:"sort-desc",part:"bar-sort-descending"}))}renderSettings(){return e("li",{class:"settings",part:"bar-settings",hidden:!this.settingable},e("button",{class:"button",part:"bar-settings-button",onClick:this.settingsClickHandler.bind(this)}))}renderResize(){return e("li",{class:"resize",part:"bar-resize",hidden:!this.resizeable},e("ch-grid-column-resize",{column:this,class:"resize-split",part:"bar-resize-split"}))}get el(){return s(this)}static get watchers(){return{size:["sizeHandler"],hidden:["hiddenHandler"],order:["orderHandler"],sortDirection:["sortDirectionHandler"]}}};m.style=":host{display:-ms-flexbox;display:flex;position:-webkit-sticky;position:sticky;top:0}:host{background-color:inherit;-webkit-margin-before:inherit;margin-block-start:inherit;-webkit-margin-after:inherit;margin-block-end:inherit;-webkit-border-before:inherit;border-block-start:inherit;-webkit-border-after:inherit;border-block-end:inherit;-webkit-padding-before:inherit;padding-block-start:inherit;-webkit-padding-after:inherit;padding-block-end:inherit;-webkit-transition:-webkit-transform var(--column-drag-transition-duration, 0.2s);transition:-webkit-transform var(--column-drag-transition-duration, 0.2s);transition:transform var(--column-drag-transition-duration, 0.2s);transition:transform var(--column-drag-transition-duration, 0.2s), -webkit-transform var(--column-drag-transition-duration, 0.2s)}:host([resizing]){cursor:ew-resize;pointer-events:none}:host([sort-direction=asc]) .bar .sort .sort-asc{visibility:visible}:host([sort-direction=desc]) .bar .sort .sort-desc{visibility:visible}:host([show-settings]){z-index:1000}.bar{list-style-type:none;margin:0;padding:0;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}.bar .name{display:-ms-flexbox;display:flex;overflow:hidden;-ms-flex-order:1;order:1}.bar .name .name-text{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.bar .sort{position:relative;-ms-flex-align:center;align-items:center;-ms-flex-order:2;order:2}.bar .sort:not([hidden]){display:-ms-flexbox;display:flex}.bar .sort .sort-asc{visibility:hidden;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards}.bar .sort .sort-desc{position:absolute;visibility:hidden;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards}.bar .settings{-ms-flex-order:3;order:3}.bar .resize{-ms-flex-item-align:stretch;align-self:stretch;margin-left:auto;-ms-flex-order:4;order:4}@-webkit-keyframes column-sort{0%{opacity:0}10%{opacity:1}90%{opacity:1}100%{opacity:0}}@keyframes column-sort{0%{opacity:0}10%{opacity:1}90%{opacity:1}100%{opacity:0}}";const b=class{constructor(i){t(this,i)}componentDidLoad(){this.columns=Array.from(this.el.querySelectorAll("ch-grid-column"))}columnResizeStartedHandler(){this.columns.forEach(t=>t.resizing=!0)}columnResizeFinishedHandler(){this.columns.forEach(t=>t.resizing=!1)}columnSortChangedHandler(t){this.columns.forEach(i=>{i.columnId!=t.detail.columnId&&(i.sortDirection=null)})}render(){return e(n,null,e("slot",null))}get el(){return s(this)}};b.style="@layer ch-grid {\n  ch-grid-columnset {\n    display: contents;\n  }\n  ch-grid-columnset.resizing ch-grid-column {\n    cursor: ew-resize;\n  }\n}\n@layer ch-grid {\n  ch-grid-row {\n    display: contents;\n  }\n}\n@layer ch-grid {\n  ch-grid-cell {\n    grid-column: var(--grid-column);\n    background-color: inherit;\n    -webkit-margin-before: inherit;\n    margin-block-start: inherit;\n    -webkit-margin-after: inherit;\n    margin-block-end: inherit;\n    -webkit-border-before: inherit;\n    border-block-start: inherit;\n    -webkit-border-after: inherit;\n    border-block-end: inherit;\n    -webkit-padding-before: inherit;\n    padding-block-start: inherit;\n    -webkit-padding-after: inherit;\n    padding-block-end: inherit;\n    -webkit-transition: -webkit-transform var(--column-drag-transition-duration, 0.2s);\n    transition: -webkit-transform var(--column-drag-transition-duration, 0.2s);\n    transition: transform var(--column-drag-transition-duration, 0.2s);\n    transition: transform var(--column-drag-transition-duration, 0.2s), -webkit-transform var(--column-drag-transition-duration, 0.2s);\n  }\n}";const p=class{constructor(e){t(this,e),this.activePageChanged=i(this,"activePageChanged",7)}navigationClickedHandler(t){}pageClickedHandler(t){}};p.style=":host{display:-ms-flexbox;display:flex}";const f=class{constructor(e){t(this,e),this.navigationClicked=i(this,"navigationClicked",7),this.handleClick=t=>{t.stopPropagation(),this.navigationClicked.emit({navigationType:this.type})}}render(){return e(n,{role:"button",tabindex:"0",disabled:this.disabled,onClick:this.handleClick})}get el(){return s(this)}};f.style="ch-paginator-navigate[disabled]{pointer-events:none}";export{d as ch_grid,c as ch_grid_action_refresh,u as ch_grid_action_settings,g as ch_grid_actionbar,m as ch_grid_column,b as ch_grid_columnset,p as ch_paginator,f as ch_paginator_navigate}